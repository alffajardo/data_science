---
title: "Ancova"
output: html_notebook
---

```{r}
library(ggplot2)
library(pastecs)
library(car)
library(effects)
```

## Read de Data
```{r}
viagraData<- as.data.frame(read.delim("ViagraCovariate.dat", header = TRUE))
viagraData$dose <- as.factor(viagraData$dose)
levels(viagraData$dose) <- c("Placebo","Low Dose","High Dose")
attach(viagraData)
```
## Exploramos los datos
un par de gráficas
```{r}
ggplot(viagraData,aes(dose,libido))+
  geom_boxplot()
ggplot(viagraData,aes(dose,partnerLibido))+
  geom_boxplot()
```
Estedísticos descriptivos
```{r}
by(viagraData$libido, viagraData$dose, stat.desc)
by(viagraData$partnerLibido, viagraData$dose, stat.desc)
```
después probamos la homogeneidad de las varianzas
```{r}
leveneTest(viagraData$libido, viagraData$dose, center = median)
```

```{r}
viagraModel<-aov(libido ~ dose, data = viagraData)
summary(viagraModel)

viagraModel<-aov(libido ~ partnerLibido + dose, data = viagraData)
summary(viagraModel)
```
## Colocar los contrastes dentro del modelo

```{r}
contrasts(viagraData$dose)<-cbind(c(-2,1,1), c(0,-1,1))
```
realizar el anova. es importante considerar el tipo de modelo que se emplea
```{r}
viagraModel<-aov(libido ~ partnerLibido + dose, data = viagraData)
Anova(viagraModel, type="III")
```
## Interpretar el anvova
No podemos interpretar la diferencia de las medias porque no están ajustadas para la covariable, de esta forma lo que debemos hacer es es ajustar las medias antes de compararalas. es por esto que usamos la función effects

```{r}
adjustedMeans<-effect("dose", viagraModel, se=TRUE)
summary(adjustedMeans)
adjustedMeans$response
```
Ahora que hemos ajustado las medias podemos saber en donde se encuentran las diferencias. usando la función summary.lm()

```{r}
summary.lm(viagraModel)
```
Hemos visto que ajustar una covariable en nuestro modelo reduce el error standar y por lo tanto se aumenta el poder estadístico de nuestro análisis. No obstante, aún debemos poner a prueba los supuestos para poder realizar el ancova.


Para probar la homogeneidad de las pendientes volveremos a correr el análisis,pero esta vez considerando la interacción de la variable y covariable 

```{r}
hoRS<-aov(libido ~ partnerLibido * dose , data =
viagraData)
```
Corremos nuevamente el análsis
```{r}
Anova(hoRS, type="III")
```
```{r}

```




